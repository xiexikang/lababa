**问题排查与目标**
- 按钮在小程序不显示：首页与个人中心按钮在 WEAPP 环境下未渲染或样式未生效/被遮挡
- 未登录行为：前端检测无 token 时应统一跳到登录页
- 邀请接口时机：首页不应在进入页面就调用邀请接口，应在用户点击“邀请粑友”时调用

**修复方案（前端）**
- 按钮渲染统一
  - 小程序端一律使用原生 `button`，H5 端使用 `nut-button`
  - 去掉 `<text>` 包裹，直接在 `button` 中放文案（避免内层元素样式被覆盖）
  - 为 `.start-btn/.auth-btn/.complete-btn/.help-btn` 定义明确样式（背景、文字颜色、尺寸、圆角、居中、z-index），不依赖组件内部结构
  - 确保弹窗/遮罩默认关闭且不叠盖按钮区域；必要时为按钮容器设置较高 `z-index`
- 未登录统一跳转
  - 在 `src/utils/request.ts` 增加导出方法 `ensureAuth(redirect?)`
    - 有 token 返回 true；无 token 构造当前路由 `path+query`（或传入 redirect），`navigateTo('/pages/login/index?redirect=...')` 并返回 false
  - 在关键交互处调用：
    - 首页“开始打卡”/“邀请粑友”按钮；
    - 排行页个人区块操作；
    - 统计详情打开；
    - 个人中心需要鉴权的操作
  - 保留请求层 401/403 统一拦截，所有接口自动跳登录（已实现）
- 邀请触发时机
  - 移除首页 `onMounted` 的邀请预取；仅在点击“邀请粑友”时：
    - `ensureAuth()` → `POST /api/friends/invite` → 得到 `inviteId` → 调用 `Taro.showShareMenu` 并由分享钩子读取 `inviteId`
  - 接受邀请仅在页面带有 `inviteId` 参数时触发 `POST /api/friends/accept`
- 分享钩子
  - `useShareAppMessage/useShareTimeline` 读取当前 `inviteId`（点击后设置到状态），拼接到 path/query；未设置时返回普通分享内容

**代码变更点（文件级）**
- `src/utils/request.ts`
  - 新增并导出 `ensureAuth(redirect?)`（复用已写的当前路由采集与登录跳转逻辑）
- `src/pages/index/index.vue`
  - 按钮统一为原生 `button`（WEAPP）；为 `.start-btn` 明确样式；
  - 移除邀请预取逻辑；新增“邀请粑友”按钮点击：`ensureAuth()` → 调用 `/api/friends/invite` → 设置 `inviteId` → 显示分享菜单
  - 保留接受邀请仅在存在 `inviteId` 参数时调用
- `src/pages/profile/index.vue`
  - 授权按钮统一为原生 `button`（WEAPP）；明确 `.auth-btn` 样式；
  - 个人中心需要鉴权的操作前调用 `ensureAuth()`
- 其他页面（排行/统计/详情）
  - 交互前调用 `ensureAuth()`；
  - 按钮按统一样式策略处理；
  - 确保弹窗默认关闭且不遮挡按钮

**样式规范（示例）**
- `.start-btn/.auth-btn`：
  - `display:flex; align-items:center; justify-content:center; height:96rpx; border-radius:999rpx; background:#8BCE92; color:#fff; font-size:32rpx; z-index:10;`
- `.complete-btn/.help-btn`：
  - 分别使用绿色/橙色背景，文字白色，保持同样尺寸与圆角

**验证步骤**
- 首页/个人中心在小程序显示按钮文案（含 emoji文案），点击正常触发交互；无遮罩叠盖
- 未登录点击任意需要鉴权操作 → 跳登录页；登录成功回原页面并触发本页 `init()`（`onShow`）
- 首页邀请只在点击后调用接口并分享；打开带 `inviteId` 的路径时仅接受邀请

**备注**
- 若后端暂未提供 `/api/friends/invite/accept`，点击邀请时提示“邀请功能暂不可用”并不阻塞其他功能
- 保持 H5 与小程序行为一致（H5 用 `nut-button`，小程序用原生 `button`）

请确认该方案，我将按上述变更点进行代码调整，并在微信开发者工具验证按钮显示、登录跳转与邀请触发时机。