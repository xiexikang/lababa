**目标**
- /pages/statistics/index 的所有指标、列表与弹窗仅展示“当前登录用户”的个人数据。
- 前端不再读取设备全量数据；接口统一按 token 识别用户，返回个人范围的数据。

**现状与问题**
- 统计页部分逻辑直接用 `store.globalState.records` 在本地计算（最近记录、周统计、日历点）。
- 打开详情已做 token 校验，但统计汇总仍可能包含非个人数据或混合数据。

**后端接口调整（按 token 识别用户，不再传 userId）**
- `GET /api/statistics/week`：返回个人本周概览
  - 返回：`{ daysCount, recordsCount, colorDist, score }`
- `GET /api/statistics/month-days`：返回本月个人有记录的日期与当天状态聚合
  - 返回：`{ days: string[], dayStatusMap: Record<string,{normal,diarrhea,constipation}> }`
- `GET /api/record/recent?limit=10`：返回个人最近记录列表
  - 返回：`list: Array<{ id, startTime, endTime, duration, color, status, shape, amount, note }>`
- `GET /api/record/:id`：返回个人记录详情（已校验 token）
- 计算评分：后端可直接按约定权重计算并返回 `score`，也可返回原始数据给前端计算（见下）

**评分规则（可在后端或前端实现）**
- 基础分 80，惩罚项：便秘 −15/次；拉肚子 −10/次；异常颜色（红/黑/灰白） −8/次；绿色 −3/次；极端时长 <60s −2、>20m −3、>40m −6；连续≥2天异常 −5
- 奖励项：正常 +2/次（上限 +20）；打卡覆盖率 +10×(打卡天数/7)（上限 +10）；间隔稳定 +5
- 结果 clamp 到 0–100

**前端改造**
- 统一请求层已支持 `requireAuth`，默认带 token；公开接口匹配 `/api/auth/**`
- 统计页用接口替换本地计算：
  1) `onMounted`：并发请求
    - `GET /api/statistics/week` → 绑定 `weeklyDaysCount`、`weeklyRecordsCount`、`weeklyColorDist`、`weeklyScore`
    - `GET /api/statistics/month-days` → 绑定 `monthMarkDays` 与 `monthDayStatus`
    - `GET /api/record/recent?limit=10` → 渲染“最近记录”列表
  2) 保留“详情弹窗”打开 `GET /api/record/:id`（已校验 token）
- 登录态处理：
  - 若无 token → `showModal` 引导至 `pages/profile/index` 授权登录；登录后重新拉取数据
- 空状态：个人记录为空时，提示文案“还没有记录哦～快去主页打卡吧！”保持现有样式

**数据一致性与迁移**
- 记录保存流程改为后端落表并返回记录；前端不再以 local-only 为主（如需保留本地缓存，仅作展示加速，数据源以接口为准）
- 在授权成功后写入 `auth-token` 与 `user-info`，统计页只按接口拉取个人范围数据

**实现分步**
1) 在统计页替换数据源为接口（不改 UI）
2) 接入评分（后端返回或前端计算），展示分数与色条
3) 登录态拦截与空状态统一
4) 验证 H5 与小程序显示一致；周起始日为周一（与当前实现一致）

**验收标准**
- 未登录：统计页提醒登录；登录后个人数据加载成功
- 统计数据与最近记录均只为当前用户；打开详情正常
- 评分在三种样本（全正常、混合、全异常）落在合理区间（≥80/60–80/≤55）

确认后我将在统计页按上述方案接入接口并移除本地混合数据计算，保证“仅个人数据”展示。