**数据结构与初始化**

* 在 `pages/statistics/index.vue` setup 顶部新增：

  * `const week = reactive({ daysCount:0, recordsCount:0, colorDist:{}, score:0, scoreDetails:[] as Array<{label:string,value:number}> })`

  * `const month = reactive({ days:[] as string[], dayStatusMap:{} as Record<string,{normal:number,diarrhea:number,constipation:number}> })`

  * `const recent = reactive({ list:[] as Array<any> })`

* 引入请求方法：`import { get } from '@/utils/request'`

**并发拉取接口（onMounted）**

* 逻辑：

  * 检查 `Taro.getStorageSync('auth-token')`；未登录 → `showModal` 引导到 `/pages/profile/index`。

  * 使用 `Promise.all` 并发：

    * `const [w,m,r] = await Promise.all([get('/api/statistics/week'), get('/api/statistics/month-days'), get('/api/record/recent',{ limit:10 })])`

    * 赋值：`Object.assign(week,w)`；`Object.assign(month,m)`；`Object.assign(recent,r)`；

  * 失败 → `Taro.showToast({ title:'加载失败', icon:'error' })`

**替换 computed 映射**

* 将本地汇总改为接口数据：

  * `weeklyDaysCount` → `computed(() => week.daysCount)`（替换 326 行声明处）

  * `weeklyRecordsCount` → `computed(() => week.recordsCount)`

  * `weeklyColorDist` → `computed(() => week.colorDist)`

  * `weeklyScore` → `computed(() => week.score)`

  * 最近记录 `records` → `computed(() => recent.list)`（替换 149 行处）

* 日历：

  * `monthMarkDays` → `computed(() => month.days)`

  * `statusForDay(day)`：从 `month.dayStatusMap[d]` 判断返回 `success|warning|danger`

**评分明细 UI**

* 在评分区域（`score-section`）增加一行说明：

  * 遍历 `week.scoreDetails` 输出 `label` 与 `value`（带 +/− 样式），例如：“便秘 −15、正常 +12、覆盖率 +6”。

* 色条颜色阈值保持现状（≥80 绿、60–79 黄、<60 红），可根据 `week.score` 动态添加类或修改渐变。

**详情弹窗**

* 保留现有结构；打开时：

  * 校验 token → `GET /api/record/:id` → 成功填充 `detail` 与 `detailVisible = true`，失败 toast。

**错误与空状态**

* 接口失败：弹 `toast`；保留空状态 `.empty-state` 提示。

* 无记录：周概览与最近记录显示空提示；评分显示 0 或“暂无”。

**鉴权与统一请求**

* 使用已实现的统一请求层，默认需鉴权；公开接口 `/api/auth/**` 不鉴权。

* 统计页接口不传 `userId`，后端按 token 返回个人数据。

**验证与回归测试**

* 未登录 → 提示并跳转授权；登录后自动加载。

* 三类周样本验证分数合理：全正常（≥80）、混合（60–80）、异常（≤55）。

* H5/小程序一致；日历状态点与最近记录均只为个人数据。

**后续（可选）**

* 将评分权重抽出到配置并在个人中心提供“评分规则”设置入口（前端生效）。

