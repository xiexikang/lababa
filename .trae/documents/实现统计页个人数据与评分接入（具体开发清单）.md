**范围与目标**

* 将 /pages/statistics/index 全部数据源改为“当前登录用户”的接口返回；移除本地混合计算

* 接入评分 score 与 scoreDetails，并在评分条旁展示明细

**接口契约**

* GET /api/statistics/week

  * 返回：{ daysCount:number, recordsCount:number, colorDist:Record\<string,number>, score:number, scoreDetails:Array<{label:string, value:number}> }

* GET /api/statistics/month-days

  * 返回：{ days:string\[], dayStatusMap:Record\<string,{normal:number, diarrhea:number, constipation:number}> }

* GET /api/record/recent?limit=10

  * 返回：{ list:Array<{ id:string, startTime:number, endTime:number, duration:number, color:string, status:string, shape:string, amount:string, note?:string }>}

* GET /api/record/:id

  * 返回：{ id, startTime, endTime, duration, color, status, shape, amount, note }

**前端数据结构**

* state：

  * week: { daysCount, recordsCount, colorDist, score, scoreDetails }

  * month: { days, dayStatusMap }

  * recent: { list }

  * detail: { visible:boolean, record?:object }

* UI 映射：

  * weeklyDaysCount ← week.daysCount

  * weeklyRecordsCount ← week.recordsCount

  * weeklyColorDist ← week.colorDist

  * weeklyScore ← week.score（保留旧 UI）

  * 日历标记 ← month.days；statusForDay(day) 使用 month.dayStatusMap

  * 最近记录列表 ← recent.list

**页面改造步骤**

1. 在统计页 setup 中创建 week/month/recent 的响应式对象
2. onMounted 并发拉取三个接口：

   * 若无 token：showModal 引导至 /pages/profile/index，并在授权后重新拉取
3. 用接口数据替换现有 computed：

   * weeklyDaysCount / weeklyRecordsCount / weeklyColorDist / weeklyScore 不再基于 store.globalState

   * statusForDay(day) 改为从 month.dayStatusMap 读取
4. 评分明细说明：在评分条旁显示 scoreDetails 列表（例如：便秘 −15、正常 +12、覆盖率 +6）
5. 详情弹窗：保持当前弹窗结构，打开时调用 GET /api/record/:id；失败 toast 错误

**错误与空状态**

* 若接口返回空：显示“还没有记录哦～快去主页打卡吧！”保留现有样式

* 接口失败：toast 错误并允许手动重试；在无 token 时不发起请求

**鉴权说明**

* 统一请求层已启用：默认需鉴权；公开接口 /api/auth/\*\* 不鉴权

* 统计页接口均按 token 返回个人数据，无需前端传 userId

**验证与回归**

* 未登录 → 弹窗提示并跳转授权；授权后返回统计页自动加载数据

* 周概览/色谱/评分与最近记录均为个人数据，H5 与小程序一致

* 评分数值在三类样本下合理：全正常（≥80）、混合（60–80）、异常（≤55）

**后续可配置（可选）**

* 将评分权重抽到配置文件，并在个人中心提供“评分规则”简单设置，仅影响前端显示

